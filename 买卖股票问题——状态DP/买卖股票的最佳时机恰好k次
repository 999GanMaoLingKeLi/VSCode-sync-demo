from functools import cache
prices=[3,3,5,0,0,3,1,4]
n=len(prices)
k=2
@cache
def dfs(i,hold,remain):
    if remain<0:
        return float('-inf')
    if i<0:
        return float('-inf') if remain !=0 else (0 if hold==0 else float('-inf'))
    if hold==0:
        return max(dfs(i-1,1,remain)+prices[i],dfs(i-1,0,remain))
    if hold==1:
        return max(dfs(i-1,0,remain-1)-prices[i],dfs(i-1,1,remain))
print(dfs(n-1,0,k))